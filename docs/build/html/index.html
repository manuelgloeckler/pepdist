

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Welcome to pepdist’s documentation! &mdash; pepdist 31.08.19 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'./',
              VERSION:'31.08.19',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home"> pepdist
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Welcome to pepdist’s documentation!</a></li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#getting-started">Getting started</a><ul>
<li><a class="reference internal" href="#similarity">Similarity</a></li>
<li><a class="reference internal" href="#distance">Distance</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">pepdist</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#">Docs</a> &raquo;</li>
        
      <li>Welcome to pepdist’s documentation!</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="welcome-to-pepdist-s-documentation">
<h1>Welcome to pepdist’s documentation!<a class="headerlink" href="#welcome-to-pepdist-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>
<div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<p>The Package can easily installed via pip. Just enter:</p>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">pepdist</span>
</pre></div>
</div>
<p>and the package and all dependencies should be installed.</p>
<p>To use the package just import it with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pepdist</span>
<span class="kn">from</span> <span class="nn">pepdist</span> <span class="kn">import</span> <span class="n">distance</span><span class="p">,</span> <span class="n">similarity</span>
</pre></div>
</div>
</div>
<div class="section" id="getting-started">
<h1>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<p>The package consists of two major sub-packages:</p>
<ul class="simple">
<li><a class="reference internal" href="#similarity">Similarity</a> : This package uses a substitution- or other scoring matrices two obtain a measurement of peptide similarity. The nearest neighbor of a given query peptide in a big set of peptides can then be computed by a fast trie-based branch and bound algorithm.</li>
<li><a class="reference internal" href="#distance">Distance</a> : This package uses a feature vector representation of the peptides given for example by the AAindex database. The distance between peptides can then be defined as the euclidean distance between these vectors. A locally sensitive hashing can then obtain the approximated nearest neighbor.</li>
</ul>
<p>While the code was designed for peptide comparison, it can also be used for other purposes.</p>
<div class="section" id="similarity">
<h2>Similarity<a class="headerlink" href="#similarity" title="Permalink to this headline">¶</a></h2>
<p>The function’s and classes are documented via autodoc here <code class="xref py py-mod docutils literal notranslate"><span class="pre">pepdist.similarity</span></code>. The main classes are <code class="xref py py-class docutils literal notranslate"><span class="pre">pepdist.similarity.Trie</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">pepdist.similarity.KmerTrie</span></code>
, which are both prefix trie data structures and both have the capability to search the nearest neighbor fast with a normalized score given a substitution/scoring matrix. Given a BLOSUM matrix, this normalization
is known as squared root blosum score, and for two peptides A and B of length n it is given as:</p>
<div class="math notranslate nohighlight">
\[score(A,B) = \frac{\sum_i^n bl(a_i,b_i)}{\sqrt{\sum_i^n bl(a_i,a_i) \cdot bl(b_i,b_i)}}\]</div>
<p>The Trie can be filled with words of different length, but the nearest neighbor search only compare sequences with the same length. Additionaly the positions of each position can be weighted by a real
value.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pepdist</span> <span class="kn">import</span> <span class="n">similarity</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AAAGG&quot;</span><span class="p">,</span> <span class="s2">&quot;AGA&quot;</span><span class="p">,</span> <span class="s2">&quot;WWYYA&quot;</span><span class="p">,</span> <span class="s2">&quot;WWWW&quot;</span><span class="p">,</span> <span class="s2">&quot;YYY&quot;</span><span class="p">,</span> <span class="s2">&quot;AYA&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trie</span> <span class="o">=</span> <span class="n">similarity</span><span class="o">.</span><span class="n">Trie</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">trie</span><span class="o">.</span><span class="n">k_nearest_neighbour</span><span class="p">(</span><span class="s2">&quot;AAA&quot;</span><span class="p">,</span> <span class="n">similarity</span><span class="o">.</span><span class="n">blosum62</span><span class="p">)</span>
<span class="go">[(&#39;AGA&#39;, 0.6172133998483676)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trie</span><span class="o">.</span><span class="n">k_nearest_neighbour</span><span class="p">(</span><span class="s2">&quot;WWYYY&quot;</span><span class="p">,</span> <span class="n">similarity</span><span class="o">.</span><span class="n">blosum62</span><span class="p">)</span>
<span class="go">[(&#39;WWYYA&#39;, 0.8198127976897006)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trie</span><span class="o">.</span><span class="n">k_nearest_neighbour</span><span class="p">(</span><span class="s2">&quot;WWYYY&quot;</span><span class="p">,</span> <span class="n">similarity</span><span class="o">.</span><span class="n">blosum62</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[(&#39;WWYYA&#39;, 1.0)]</span>
</pre></div>
</div>
<p>The kmerTrie can be used in a similar way. However given a number k, it also saves all k-mers for all word
in the trie. This can be used to not only score equal length peptides, rather you can find the best scoring
substring of length k.</p>
</div>
<div class="section" id="distance">
<h2>Distance<a class="headerlink" href="#distance" title="Permalink to this headline">¶</a></h2>
<p>The function’s and classes are documented via autodoc here <code class="xref py py-mod docutils literal notranslate"><span class="pre">pepdist.distance</span></code>. The main classes are <code class="xref py py-class docutils literal notranslate"><span class="pre">pepdist.distance.Aaindex</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">pepdist.distance.descriptor</span></code> and
<code class="xref py py-class docutils literal notranslate"><span class="pre">pepdist.distance.LSH</span></code>. The Aaindex class parse the AAindex database into python dictionaries. This indices map an amino acid to a real value and therefore can be used to map peptides to a feature
vector representing a physical or chemical property. The distance between two peptides can then be represented as the euclidean distance of the feature vectors. However, encoding a peptide with multiple
indices can lead to very high dimensional feature vectors. For an efficient approximate nearest neighbor search, a locally sensitive hashing was implemented, which allows blazing fast search times.
Here are some example of how to use it:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pepdist</span> <span class="kn">import</span> <span class="n">distance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AAAGG&quot;</span><span class="p">,</span> <span class="s2">&quot;AGAAA&quot;</span><span class="p">,</span> <span class="s2">&quot;WWYYA&quot;</span><span class="p">,</span> <span class="s2">&quot;WWWWA&quot;</span><span class="p">,</span> <span class="s2">&quot;YYYWW&quot;</span><span class="p">,</span> <span class="s2">&quot;AYAWW&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">AA</span> <span class="o">=</span> <span class="n">distance</span><span class="o">.</span><span class="n">Aaindex</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">desc</span> <span class="o">=</span> <span class="n">distance</span><span class="o">.</span><span class="n">IndexDescriptor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="n">AA</span><span class="p">[</span><span class="s2">&quot;GEIM800103&quot;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">desc</span><span class="o">.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">desc</span><span class="o">.</span><span class="n">sequences</span>
<span class="go">[&#39;AAAGG&#39;, &#39;AGAAA&#39;, &#39;WWYYA&#39;, &#39;WWWWA&#39;, &#39;YYYWW&#39;, &#39;AYAWW&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">desc</span><span class="o">.</span><span class="n">descriptors</span>
<span class="go">[array([1.55, 1.55, 1.55, 0.59, 0.59]), array([1.55, 0.59, 1.55, 1.55, 1.55]), array([1.86, 1.86, 1.08, 1.08, 1.55]), array([1.86, 1.86, 1.86, 1.86, 1.55]), array([1.08, 1.08, 1.08, 1.86, 1.86]), array([1.55, 1.08, 1.55, 1.86, 1.86])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">desc</span><span class="o">.</span><span class="n">change_norm_method</span><span class="p">(</span><span class="n">distance</span><span class="o">.</span><span class="n">z_normalize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">desc</span><span class="o">.</span><span class="n">descriptors</span>
<span class="go">[array([ 1.02132811,  1.02132811,  1.02132811, -1.01708142, -1.01708142]), array([ 1.02132811, -1.01708142,  1.02132811,  1.02132811,  1.02132811]), array([1.67956452, 1.67956452, 0.02335678, 0.02335678, 1.02132811]), array([1.67956452, 1.67956452, 1.67956452, 1.67956452, 1.02132811]), array([0.02335678, 0.02335678, 0.02335678, 1.67956452, 1.67956452]), array([1.02132811, 0.02335678, 1.02132811, 1.67956452, 1.67956452])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lsh</span> <span class="o">=</span> <span class="n">distance</span><span class="o">.</span><span class="n">LSH</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lsh</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">desc</span><span class="o">.</span><span class="n">sequences</span><span class="p">,</span> <span class="n">desc</span><span class="o">.</span><span class="n">descriptors</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lsh</span><span class="o">.</span><span class="n">nearest_neighbour</span><span class="p">(</span><span class="n">desc</span><span class="o">.</span><span class="n">descriptors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">(&#39;AAAGG&#39;, 0.0)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Manuel Glöckler

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>